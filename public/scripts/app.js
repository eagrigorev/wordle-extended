import { KEYS, ROWS, WORDLE } from './const.js';
const field = document.querySelector('.game-container__field');
const keyboard = document.querySelector('.game-container__keyboard');
const message = document.querySelector('.game-container__message');
let row = 0;
let tile = 0;
let gameOver = false;
ROWS.forEach((row, rowIndex) => {
    const rowElement = document.createElement('div');
    rowElement.setAttribute('id', `row-${rowIndex}`);
    row.forEach((tile, tileIndex) => {
        const tileElement = document.createElement('div');
        tileElement.setAttribute('id', `row-${rowIndex}-tile-${tileIndex}`);
        tileElement.classList.add('game-container__tile');
        rowElement.append(tileElement);
    });
    if (field != null) {
        field.append(rowElement);
    }
});
KEYS.forEach((key) => {
    const button = document.createElement('button');
    button.textContent = key;
    button.setAttribute('id', key);
    button.addEventListener('click', () => handleClick(key));
    if (keyboard != null) {
        keyboard.append(button);
    }
});
const handleClick = (key) => {
    console.log(`Clicked ${key}`);
    if (key === 'DELETE') {
        deleteLetter();
        return;
    }
    if (key === 'ENTER') {
        checkWordle();
        return;
    }
    addLetter(key);
};
const addLetter = (key) => {
    if (row < 7 && tile < 6) {
        const currentTile = document.getElementById(`row-${row}-tile-${tile}`);
        if (currentTile != null) {
            currentTile.textContent = key;
            currentTile.setAttribute('data', key);
            ROWS[row][tile] = key;
            tile++;
            console.log(ROWS);
        }
    }
};
const deleteLetter = () => {
    if (tile > 0) {
        tile--;
        const currentTile = document.getElementById(`row-${row}-tile-${tile}`);
        if (currentTile != null) {
            currentTile.textContent = '';
            currentTile.setAttribute('data', '');
            ROWS[row][tile] = '';
        }
    }
};
const checkWordle = () => {
    if (tile > 5) {
        const userWordle = ROWS[row].join('');
        flipColorsAnimation();
        console.log(`User word is ${userWordle} and the correct word is ${WORDLE}`);
        if (userWordle === WORDLE) {
            displayMessage('Correct!');
            gameOver = true;
            return;
        }
        else {
            if (row >= 6) {
                displayMessage('Game Over');
                gameOver = true;
                return;
            }
            if (row < 6) {
                row++;
                tile = 0;
            }
        }
    }
};
const displayMessage = (msg) => {
    const messageBody = document.createElement('p');
    messageBody.textContent = msg;
    if (message != null) {
        message.append(messageBody);
        setTimeout(() => {
            message.removeChild(messageBody);
        }, 3000);
    }
};
const flipColorsAnimation = () => {
    const parentRow = document.querySelector(`#row-${row}`);
    if (parentRow != null) {
        const tiles = Object.values(parentRow.childNodes);
        tiles.forEach((tile, index) => {
            const tileData = tile.getAttribute('data');
            if (tileData == WORDLE[index]) {
                tile.classList.remove('game-container__tile');
                tile.classList.add('game-container__tile_green');
            }
            else {
                if (WORDLE.includes(tileData)) {
                    tile.classList.remove('game-container__tile');
                    tile.classList.add('game-container__tile_yellow');
                }
                else {
                    tile.classList.remove('game-container__tile');
                    tile.classList.add('game-container__tile_grey');
                }
            }
        });
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2FwcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFFaEQsTUFBTSxLQUFLLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO0FBQy9ELE1BQU0sUUFBUSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsMkJBQTJCLENBQUMsQ0FBQztBQUNyRSxNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLDBCQUEwQixDQUFDLENBQUM7QUFFbkUsSUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFDO0FBQ1osSUFBSSxJQUFJLEdBQUcsQ0FBQyxDQUFDO0FBQ2IsSUFBSSxRQUFRLEdBQUcsS0FBSyxDQUFDO0FBRXJCLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFhLEVBQUUsUUFBZ0IsRUFBRSxFQUFFO0lBQy9DLE1BQU0sVUFBVSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDakQsVUFBVSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsT0FBTyxRQUFRLEVBQUUsQ0FBQyxDQUFDO0lBQ2pELEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFZLEVBQUUsU0FBaUIsRUFBRSxFQUFFO1FBQzlDLE1BQU0sV0FBVyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDbEQsV0FBVyxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsT0FBTyxRQUFRLFNBQVMsU0FBUyxFQUFFLENBQUMsQ0FBQztRQUNwRSxXQUFXLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO1FBQ2xELFVBQVUsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDakMsQ0FBQyxDQUFDLENBQUM7SUFD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QVEsSUFBSSxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUU7Z0JBQzdCLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLHNCQUFzQixDQUFDLENBQUM7Z0JBQzlDLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLDRCQUE0QixDQUFDLENBQUM7YUFDbEQ7aUJBQU07Z0JBQ0wsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxFQUFFO29CQUM3QixJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO29CQUM5QyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO2lCQUNuRDtxQkFBTTtvQkFDTCxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO29CQUM5QyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQywyQkFBMkIsQ0FBQyxDQUFDO2lCQUNqRDthQUNGO1FBQ0gsQ0FBQyxDQUFDLENBQUM7S0FDSjtBQUNILENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEtFWVMsIFJPV1MsIFdPUkRMRSB9IGZyb20gJy4vY29uc3QuanMnO1xyXG5cclxuY29uc3QgZmllbGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FtZS1jb250YWluZXJfX2ZpZWxkJyk7XHJcbmNvbnN0IGtleWJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdhbWUtY29udGFpbmVyX19rZXlib2FyZCcpO1xyXG5jb25zdCBtZXNzYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdhbWUtY29udGFpbmVyX19tZXNzYWdlJyk7XHJcblxyXG5sZXQgcm93ID0gMDtcclxubGV0IHRpbGUgPSAwO1xyXG5sZXQgZ2FtZU92ZXIgPSBmYWxzZTtcclxuXHJcblJPV1MuZm9yRWFjaCgocm93OiBzdHJpbmdbXSwgcm93SW5kZXg6IG51bWJlcikgPT4ge1xyXG4gIGNvbnN0IHJvd0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICByb3dFbGVtZW50LnNldEF0dHJpYnV0ZSgnaWQnLCBgcm93LSR7cm93SW5kZXh9YCk7XHJcbiAgcm93LmZvckVhY2goKHRpbGU6IHN0cmluZywgdGlsZUluZGV4OiBudW1iZXIpID0+IHtcclxuICAgIGNvbnN0IHRpbGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICB0aWxlRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2lkJywgYHJvdy0ke3Jvd0luZGV4fS10aWxlLSR7dGlsZUluZGV4fWApO1xyXG4gICAgdGlsZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZ2FtZS1jb250YWluZXJfX3RpbGUnKTtcclxuICAgIHJvd0VsZW1lbnQuYXBwZW5kKHRpbGVFbGVtZW50KTtcclxuICB9KTtcclxuICBpZiAoZmllbGQgIT0gbnVsbCkge1xyXG4gICAgZmllbGQuYXBwZW5kKHJvd0VsZW1lbnQpO1xyXG4gIH1cclxufSk7XHJcblxyXG5LRVlTLmZvckVhY2goKGtleTogc3RyaW5nKSA9PiB7XHJcbiAgY29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XHJcbiAgYnV0dG9uLnRleHRDb250ZW50ID0ga2V5O1xyXG4gIGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2lkJywga2V5KTtcclxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKTogdm9pZCA9PiBoYW5kbGVDbGljayhrZXkpKTtcclxuICBpZiAoa2V5Ym9hcmQgIT0gbnVsbCkge1xyXG4gICAga2V5Ym9hcmQuYXBwZW5kKGJ1dHRvbik7XHJcbiAgfVxyXG59KTtcclxuXHJcbmNvbnN0IGhhbmRsZUNsaWNrID0gKGtleTogc3RyaW5nKTogdm9pZCA9PiB7XHJcbiAgY29uc29sZS5sb2coYENsaWNrZWQgJHtrZXl9YCk7XHJcbiAgaWYgKGtleSA9PT0gJ0RFTEVURScpIHtcclxuICAgIGRlbGV0ZUxldHRlcigpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBpZiAoa2V5ID09PSAnRU5URVInKSB7XHJcbiAgICBjaGVja1dvcmRsZSgpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBhZGRMZXR0ZXIoa2V5KTtcclxufTtcclxuXHJcbmNvbnN0IGFkZExldHRlciA9IChrZXk6IHN0cmluZyk6IHZvaWQgPT4ge1xyXG4gIGlmIChyb3cgPCA3ICYmIHRpbGUgPCA2KSB7XHJcbiAgICBjb25zdCBjdXJyZW50VGlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGByb3ctJHtyb3d9LXRpbGUtJHt0aWxlfWApO1xyXG4gICAgaWYgKGN1cnJlbnRUaWxlICE9IG51bGwpIHtcclxuICAgICAgY3VycmVudFRpbGUudGV4dENvbnRlbnQgPSBrZXk7XHJcbiAgICAgIGN1cnJlbnRUaWxlLnNldEF0dHJpYnV0ZSgnZGF0YScsIGtleSk7XHJcbiAgICAgIFJPV1Nbcm93XVt0aWxlXSA9IGtleTtcclxuICAgICAgdGlsZSsrO1xyXG4gICAgICBjb25zb2xlLmxvZyhST1dTKTtcclxuICAgIH1cclxuICB9XHJcbn07XHJcblxyXG5jb25zdCBkZWxldGVMZXR0ZXIgPSAoKTogdm9pZCA9PiB7XHJcbiAgaWYgKHRpbGUgPiAwKSB7XHJcbiAgICB0aWxlLS07XHJcbiAgICBjb25zdCBjdXJyZW50VGlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGByb3ctJHtyb3d9LXRpbGUtJHt0aWxlfWApO1xyXG4gICAgaWYgKGN1cnJlbnRUaWxlICE9IG51bGwpIHtcclxuICAgICAgY3VycmVudFRpbGUudGV4dENvbnRlbnQgPSAnJztcclxuICAgICAgY3VycmVudFRpbGUuc2V0QXR0cmlidXRlKCdkYXRhJywgJycpO1xyXG4gICAgICBST1dTW3Jvd11bdGlsZV0gPSAnJztcclxuICAgIH1cclxuICB9XHJcbn07XHJcblxyXG5jb25zdCBjaGVja1dvcmRsZSA9ICgpOiB2b2lkID0+IHtcclxuICBpZiAodGlsZSA+IDUpIHtcclxuICAgIGNvbnN0IHVzZXJXb3JkbGU6IHN0cmluZyA9IFJPV1Nbcm93XS5qb2luKCcnKTtcclxuICAgIGZsaXBDb2xvcnNBbmltYXRpb24oKTtcclxuICAgIGNvbnNvbGUubG9nKGBVc2VyIHdvcmQgaXMgJHt1c2VyV29yZGxlfSBhbmQgdGhlIGNvcnJlY3Qgd29yZCBpcyAke1dPUkRMRX1gKTtcclxuICAgIGlmICh1c2VyV29yZGxlID09PSBXT1JETEUpIHtcclxuICAgICAgZGlzcGxheU1lc3NhZ2UoJ0NvcnJlY3QhJyk7XHJcbiAgICAgIGdhbWVPdmVyID0gdHJ1ZTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKHJvdyA+PSA2KSB7XHJcbiAgICAgICAgZGlzcGxheU1lc3NhZ2UoJ0dhbWUgT3ZlcicpO1xyXG4gICAgICAgIGdhbWVPdmVyID0gdHJ1ZTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHJvdyA8IDYpIHtcclxuICAgICAgICByb3crKztcclxuICAgICAgICB0aWxlID0gMDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IGRpc3BsYXlNZXNzYWdlID0gKG1zZzogc3RyaW5nKTogdm9pZCA9PiB7XHJcbiAgY29uc3QgbWVzc2FnZUJvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgbWVzc2FnZUJvZHkudGV4dENvbnRlbnQgPSBtc2c7XHJcbiAgaWYgKG1lc3NhZ2UgIT0gbnVsbCkge1xyXG4gICAgbWVzc2FnZS5hcHBlbmQobWVzc2FnZUJvZHkpO1xyXG4gICAgc2V0VGltZW91dCgoKTogdm9pZCA9PiB7XHJcbiAgICAgIG1lc3NhZ2UucmVtb3ZlQ2hpbGQobWVzc2FnZUJvZHkpO1xyXG4gICAgfSwgMzAwMCk7XHJcbiAgfVxyXG59O1xyXG5cclxuY29uc3QgZmxpcENvbG9yc0FuaW1hdGlvbiA9ICgpOiB2b2lkID0+IHtcclxuICBjb25zdCBwYXJlbnRSb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjcm93LSR7cm93fWApO1xyXG4gIGlmIChwYXJlbnRSb3cgIT0gbnVsbCkge1xyXG4gICAgY29uc3QgdGlsZXMgPSBPYmplY3QudmFsdWVzKHBhcmVudFJvdy5jaGlsZE5vZGVzKSBhcyBIVE1MRWxlbWVudFtdO1xyXG4gICAgdGlsZXMuZm9yRWFjaCgodGlsZSwgaW5kZXg6IG51bWJlcikgPT4ge1xyXG4gICAgICBjb25zdCB0aWxlRGF0YSA9IHRpbGUuZ2V0QXR0cmlidXRlKCdkYXRhJyk7XHJcbiAgICAgIGlmICh0aWxlRGF0YSA9PSBXT1JETEVbaW5kZXhdKSB7XHJcbiAgICAgICAgdGlsZS5jbGFzc0xpc3QucmVtb3ZlKCdnYW1lLWNvbnRhaW5lcl9fdGlsZScpO1xyXG4gICAgICAgIHRpbGUuY2xhc3NMaXN0LmFkZCgnZ2FtZS1jb250YWluZXJfX3RpbGVfZ3JlZW4nKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBpZiAoV09SRExFLmluY2x1ZGVzKHRpbGVEYXRhKSkge1xyXG4gICAgICAgICAgdGlsZS5jbGFzc0xpc3QucmVtb3ZlKCdnYW1lLWNvbnRhaW5lcl9fdGlsZScpO1xyXG4gICAgICAgICAgdGlsZS5jbGFzc0xpc3QuYWRkKCdnYW1lLWNvbnRhaW5lcl9fdGlsZV95ZWxsb3cnKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGlsZS5jbGFzc0xpc3QucmVtb3ZlKCdnYW1lLWNvbnRhaW5lcl9fdGlsZScpO1xyXG4gICAgICAgICAgdGlsZS5jbGFzc0xpc3QuYWRkKCdnYW1lLWNvbnRhaW5lcl9fdGlsZV9ncmV5Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn07Il19